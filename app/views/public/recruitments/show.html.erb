募集詳細
<div class="d-flex flex-row">
    <p><%= image_tag @recruitment.shop.img %></p>
        <div>
            <p><strong><%= link_to @recruitment.shop.name, @recruitment.shop.url %></strong></p>
            <p><%= @recruitment.shop.catch %></p>
            <p><%= @recruitment.shop.genre %></p>
            <p><%= @recruitment.shop.budget_average %></p>
            <p><%= @recruitment.shop.address %></p>
            <p><%= @recruitment.shop.access %></p>
            <p><%= @recruitment.shop.parking %></p>
            <p><%= @recruitment.shop.open %></p>
            <p><%= @recruitment.shop.close %></p>
        </div>
</div>

<% if @recruitment.user.image.attached? %>
<p><%= image_tag @recruitment.user.image, size: "100x100" %></p>
<% else %>
<p><%= image_tag 'no_image', size: "100x100" %></p>
<% end %>
<p><%= @recruitment.user.nickname %></p>
<p><%= @recruitment.title %></p>
<p><%= @recruitment.introduction %></p>
<p><%= @recruitment.schedule %></p>
<p><%= @recruitment.prefecture %></p>
<p><%= @recruitment.number_of_people_i18n %></p>
<p><%= @recruitment.recruitment_gender_i18n %></p>
<p><%= @recruitment.deadline %></p>

<% if @recruitment.user_id != current_user.id %>
    <% if @recruitment.is_valid==true && @applications.where(applicant_id: current_user.id).exists? %>  <!--whereメソッドで条件を絞り込んで確認-->
        <p><%= link_to "キャンセルする", cancel_recruitment_applications_path(@recruitment.id), method: :post %></p>
    <% elsif @recruitment.is_valid==true && @applications.where(applicant_id: current_user.id).blank? %>
        <p><%= link_to "行きたい！", confirm_recruitment_applications_path(@recruitment.id), method: :post %></p>
    <% elsif @recruitment.is_valid==false && @application.is_approval==false && %>
        <p>この募集は締め切られました</p>
    <% else @recruitment.is_valid==false && @application.is_approval==true && %>
        <p>こちらの募集は終了しました。</p>
        <p>参加者は以下の方々です。</p>
            <% @chat_group_users.each do |chat_group_user| %>
                <% if chat_group_user.user.image.attached? %>
                    <p><%= image_tag chat_group_user.user.image, size: "200x200" %></p>
                <% else %>
                    <p><%= image_tag 'no_image', size: "200x200" %></p>
                <% end %>
                    <p><%= chat_group_user.user.nickname %></p>
            <% end %>
    <% end %>
<% end %>

<% if @recruitment.user_id == current_user.id %>
    <p><%= link_to "編集", edit_recruitment_path %></p>
    <p><%= link_to '削除', withdraw_recruitment_path(@recruitment.id), { method: :withdraw, form: { data: { turbo_confirm: "本当に削除しますか？" } } }  %></p>

        <% if @recruitment.is_valid == true && @applications.present? %>
            <p>応募者が来ました！どなたと一緒に行きますか？（行きたい人全員にチェックボックスを入れてください）</p>
                <%= form_with model: @chat_group_user, url: confirm_recruitment_path(@recruitment.id),method: :post do |f| %>
                   <% @applications.each.with_index do |application| %>
                        <%= f.check_box :user_ids, {:multiple => true}, application.applicant_id.to_s, false %>
                        <p><%= link_to application.applicant.nickname, user_path(application.applicant.id) %></p>
                        <p><%= application.message %></p>
                        <p><%= application.schedule_one %></p>
                        <p><%= application.schedule_two %></p>
                        <p><%= application.schedule_three %></p>
                    <% end %>

                    <%= f.submit "次へ進む" %>
                <% end %>
        <% elsif @recruitment.is_valid == true && @applications.blank? %>
            <p>まだ応募は来ていません。</p>
        <% elsif @recruitment.is_valid == false && @applications.present? %>
            <p>こちらの募集は終了しました。</p>
            <p>参加者は以下の方々です。</p>
               <% @chat_group_users.each do |chat_group_user| %>
                    <% if chat_group_user.user.image.attached? %>
                        <p><%= image_tag chat_group_user.user.image, size: "200x200" %></p>
                    <% else %>
                        <p><%= image_tag 'no_image', size: "200x200" %></p>
                    <% end %>
                        <p><%= chat_group_user.user.nickname %></p>
            　<% end %>
        <% else @recruitment.is_valid == false && @applications.blank? %>
            <p>参加者は集まりませんでした・・・</p>
        <% end %>

<% end %>

